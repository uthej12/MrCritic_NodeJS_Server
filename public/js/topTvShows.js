import{key,tmdb,njs,img,cast_img}from"../js/serverDetails.js";var qs=new URL(document.location).searchParams,pagenum=Number(qs.get("page")),start=-1,end=20;pagenum>1&&(start=(end=20*pagenum)-20),$(document).ready(()=>{$(".pagination #"+pagenum).addClass("active"),1!=pagenum?$(".pagination #previous").attr("href","topTvShow.html?page="+(pagenum-1)):$(".pagination #previous").addClass("disabled"),10!=pagenum?$(".pagination #next").attr("href","topTvShow.html?page="+(pagenum+1)):$(".pagination #next").addClass("disabled");$.ajax({url:njs+"toptv",method:"GET",dataType:"JSON"}).done(a=>{console.log(a),$.each(a,(a,e)=>{a>start&a<end&&$(".movies").append("<div class='row element'><div class='col-5 col-sm-4 mov-img-container'><a href='tvPage.html?_id="+e._id+"'><img src='"+cast_img+e.poster_path+"' class='img-responsive mov-img'></a></div><div class='col-7 col-sm-8' style='padding: 0px'><div class='container-fluid'><div class='row'><div class='col-12'><h2 class='mov-title'><a href='tvPage.html?_id="+e._id+"'>"+e.name+" </a></h2><h4 class='mov-year'>"+e.first_air_date.split("-")[0]+"</h4></div><div class='col-12'><div class='mov-desc'><p>"+e.overview+"</p></div></div></div></div></div></div><hr class='div-line'>")})}).fail(()=>{console.log("Error")})}),null==localStorage.getItem("token")?($(".authenticated").hide(),$("#loginButton").on("click",()=>{var a=$('[name="uname"]').val(),e=$('[name="password"]').val();console.log(JSON.stringify({username:a,password:e})),""!=a&&""!=e?$.ajax({type:"POST",dataType:"json",contentType:"application/json;charset=utf-8",url:njs+"users/login",data:JSON.stringify({username:a,password:e}),success:a=>{console.log(a),1==a.success&&($("#loginModal").modal("toggle"),$(".auth").hide(),$(".authenticated").show(),localStorage.setItem("token",a.token),location.reload())},error:a=>{alert("Invalid Credentials"),console.log(a)}}):alert("Enter valid data")}),$("#signup").on("click",()=>{var a=$('[name="name"]').val(),e=$('[name="email"]').val(),o=$('[name="runame"]').val(),s=$('[name="rpassword"]').val();$('[name="password2"]').val();console.log(JSON.stringify({name:a,email:e,username:o,password:s})),""!=o&&""!=s?$.ajax({type:"POST",dataType:"json",contentType:"application/json;charset=utf-8",url:njs+"users/signup",data:JSON.stringify({name:a,email:e,username:o,password:s}),success:a=>{console.log(a),1==a.success&&($("#registerModal").modal("toggle"),$("#loginModal").modal("toggle"))},error:a=>{alert("Invalid Credentials"),console.log(a)}}):alert("Enter valid data")})):($.ajax({type:"GET",url:njs+"users",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+localStorage.getItem("token"))},dataType:"json",success:a=>{$(".logo .name").append(a.name),console.log(a)},error:a=>{console.log(a)}}),$(".authenticated").show(),$(".auth").hide(),$("#logout").click(()=>{confirm("Do want to logout?")&&(console.log(localStorage.getItem("token")),localStorage.clear(),$(".auth").show(),$(".authenticated").hide(),location.reload())})),$(".dropdown-menu a.dropdown-toggle").on("click",function(a){return $(this).next().hasClass("show")||$(this).parents(".dropdown-menu").first().find(".show").removeClass("show"),$(this).next(".dropdown-menu").toggleClass("show"),$(this).parents("li.nav-item.dropdown.show").on("hidden.bs.dropdown",function(a){$(".dropdown-submenu .show").removeClass("show")}),!1});